<?xml version="1.0" encoding="utf-8" ?>
<views:BasePage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:views="clr-namespace:MauiBankingExercise.Views"
             xmlns:viewmodels="clr-namespace:MauiBankingExercise.ViewModels"
             xmlns:models="clr-namespace:MauiBankingExercise.Models"
             x:Class="MauiBankingExercise.Views.CustomerDashboardView"
             x:DataType="viewmodels:CustomerDashboardViewModel"
             Title="Customer Dashboard">
    <Grid RowDefinitions="Auto,*" Padding="20">
        <!-- Customer Information Section -->
        <StackLayout Grid.Row="0" Spacing="15">
            <Border BackgroundColor="Transparent" 
                    StrokeShape="RoundRectangle 10"
                    StrokeThickness="0">
                <Grid HeightRequest="200">
                    <!-- Background Image -->
                    <Image Source="{Binding Customer.BankId, StringFormat='bank{0}.png'}" 
                           Aspect="AspectFill"
                           VerticalOptions="Fill"
                           HorizontalOptions="Fill">
                        <Image.Clip>
                            <RoundRectangleGeometry CornerRadius="10" Rect="0,0,1000,1000" />
                        </Image.Clip>
                    </Image>
                    
                    <!-- Content on top -->
                    <Grid RowDefinitions="*,Auto,Auto" Padding="10">
                        <!-- Top area for logo/branding space -->
                        <StackLayout Grid.Row="0" VerticalOptions="Start" HorizontalOptions="End">
                            <!-- Space for bank logo or chip -->
                        </StackLayout>
                        
                        <!-- Cardholder Name - Side by side like real credit cards -->
                        <StackLayout Grid.Row="1" 
                                     Orientation="Horizontal" 
                                     Spacing="10" 
                                     VerticalOptions="Center"
                                     HorizontalOptions="Start"
                                     Margin="0,20,0,0">
                            <Label Text="{Binding Customer.FirstName}" 
                                   FontFamily="monospace" 
                                   FontAttributes="Bold" 
                                   FontSize="18" 
                                   TextColor="White" 
                                   CharacterSpacing="1.5" />
                            
                            <Label Text="{Binding Customer.LastName}" 
                                   FontFamily="monospace" 
                                   FontAttributes="Bold" 
                                   FontSize="18" 
                                   TextColor="White" 
                                   CharacterSpacing="1.5" />
                        </StackLayout>
                        
                        <!-- Bottom info - Like expiry date area on real cards -->
                        <StackLayout Grid.Row="2" 
                                     Orientation="Horizontal" 
                                     Spacing="40" 
                                     VerticalOptions="End"
                                     HorizontalOptions="Start"
                                     Margin="0,10,0,5">
                            <Label Text="MEMBER SINCE" 
                                   FontFamily="monospace" 
                                   FontSize="9" 
                                   TextColor="LightGray" 
                                   CharacterSpacing="0.5" />
                        </StackLayout>
                    </Grid>
                </Grid>
            </Border>

            <!-- Contact Information Block -->
            <Border BackgroundColor="White" 
                    Padding="15" 
                    StrokeShape="RoundRectangle 8"
                    Stroke="LightGray"
                    StrokeThickness="1">
                <VerticalStackLayout Spacing="12">
                    <!-- Phone Number -->
                    <StackLayout Spacing="4">
                        <Label Text="Phone" 
                               FontSize="12" 
                               TextColor="Gray" 
                               FontAttributes="Bold" />
                        <Label Text="{Binding Customer.PhoneNumber}" 
                               FontFamily="monospace" 
                               FontAttributes="Bold" 
                               FontSize="16" 
                               TextColor="Black" 
                               CharacterSpacing="1"
                               HorizontalOptions="Start" />
                    </StackLayout>
                    
                    <!-- ID Number -->
                    <StackLayout Spacing="4">
                        <Label Text="Identity Number" 
                               FontSize="12" 
                               TextColor="Gray" 
                               FontAttributes="Bold" />
                        <Label Text="{Binding Customer.IdentityNumber}" 
                               FontFamily="monospace" 
                               FontSize="14" 
                               TextColor="Black" 
                               CharacterSpacing="0.5"
                               HorizontalOptions="Start" />
                    </StackLayout>
                    
                    <!-- Email -->
                    <StackLayout Spacing="4">
                        <Label Text="Email" 
                               FontSize="12" 
                               TextColor="Gray" 
                               FontAttributes="Bold" />
                        <Label Text="{Binding Customer.Email}" 
                               FontFamily="monospace" 
                               FontSize="14" 
                               TextColor="Black" 
                               CharacterSpacing="0.3"
                               HorizontalOptions="Start" />
                    </StackLayout>
                </VerticalStackLayout>
            </Border>

            <Label Text="Accounts" 
                   FontSize="20" 
                   FontAttributes="Bold"
                   Margin="0,20,0,10" />
        </StackLayout>

        <!-- Accounts CollectionView -->
        <CollectionView Grid.Row="1"
                       ItemsSource="{Binding Accounts}" 
                       BackgroundColor="Transparent"
                       SelectionMode="Single"
                       SelectedItem="{Binding SelectedAccount}"
                       SelectionChangedCommand="{Binding AccountSelectedCommand}">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:Account">
                    <Border BackgroundColor="White" 
                            Margin="0,5"
                            Padding="15" 
                            StrokeShape="RoundRectangle 8"
                            Stroke="LightGray"
                            StrokeThickness="1"
                            Style="{StaticResource CollectionViewItemBorder}">
                            
                        <Grid RowDefinitions="Auto,Auto,Auto" 
                              ColumnDefinitions="*,Auto">
                            
                            <!-- Account Number -->
                            <Label Grid.Row="0" Grid.Column="0"
                                   Text="{Binding AccountNumber}" 
                                   FontAttributes="Bold" 
                                   FontSize="16" />
                            
                            <!-- Account Balance -->
                            <Label Grid.Row="0" Grid.Column="1"
                                   Text="{Binding AccountBalance, StringFormat='{0:C}'}" 
                                   FontAttributes="Bold" 
                                   FontSize="16"
                                   HorizontalOptions="End" />
                            
                            <!-- Date Opened -->
                            <Label Grid.Row="1" Grid.Column="0"
                                   Text="{Binding DateOpened, StringFormat='Opened: {0:MM/dd/yyyy}'}" 
                                   FontSize="12"
                                   TextColor="Gray" />
                            
                            <!-- Active Status -->
                            <Label Grid.Row="1" Grid.Column="1"
                                   Text="{Binding IsActive, StringFormat='Status: {0}'}" 
                                   FontSize="12"
                                   TextColor="Gray"
                                   HorizontalOptions="End" />
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
            </CollectionView>
                   
        </Grid>
</views:BasePage>
